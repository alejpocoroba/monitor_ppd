"grupo" =  c(0, 0, 0, 0, 0, 0, 0, 0, 0, 0))
df_grupos <- df_gc_full %>%
# variables de interés
select(estado, grupo) %>%
group_by(estado, grupo) %>%
summarize(total_grupos = n()) %>%
drop_na(grupo) %>%
group_by(estado) %>%
summarize(total_grupos = n()) %>%
bind_rows(estados_faltan) %>%
mutate(region = str_sub(estado, -2, -1)) %>%
left_join(mxstate.map)
ggplot(
# Datos
df_grupos,
# Coordenadas
aes(long, lat, group = group, fill = total_grupos)) +
coord_map() +
geom_polygon(color = "black", size = .2, show.legend = T, alpha = 1) +
labs(title = "Presencia criminal en México",
subtitle = "Entre julio, agosto y septiembre del 2022\n",
fill = "Número",
caption = "Fuente: Monitor-PPD (2022)") +
theme(axis.line = element_blank(),
axis.ticks = element_blank(),
axis.text = element_blank(),
axis.title = element_blank(),
panel.background = element_rect(fill = "white",
colour = NA))
df_grupos <- df_gc_full %>%
# variables de interés
select(estado, grupo) %>%
group_by(estado, grupo) %>%
summarize(total_grupos = n()) %>%
drop_na(grupo) %>%
group_by(estado) %>%
summarize(total_grupos = n()) %>%
bind_rows(estados_faltan) %>%
mutate(region = str_sub(estado, -2, -1))
estados_faltan <- data.frame("estado" = c("Campeche-04", "Coahuila-05", "Colima-06", "Durango-10", "Estado de México-15",
"Oaxaca-20", "Querétaro-22", "Tabasco-27", "Tlaxcala-29", "Yucatán-31"),
"total_grupo" =  c(0, 0, 0, 0, 0, 0, 0, 0, 0, 0))
df_grupos <- df_gc_full %>%
# variables de interés
select(estado, grupo) %>%
group_by(estado, grupo) %>%
summarize(total_grupos = n()) %>%
drop_na(grupo) %>%
group_by(estado) %>%
summarize(total_grupos = n()) %>%
bind_rows(estados_faltan) %>%
mutate(region = str_sub(estado, -2, -1))
estados_faltan <- data.frame("estado" = c("Campeche-04", "Coahuila-05", "Colima-06", "Durango-10", "Estado de México-15",
"Oaxaca-20", "Querétaro-22", "Tabasco-27", "Tlaxcala-29", "Yucatán-31"),
"total_grupos" =  c(0, 0, 0, 0, 0, 0, 0, 0, 0, 0))
df_grupos <- df_gc_full %>%
# variables de interés
select(estado, grupo) %>%
group_by(estado, grupo) %>%
summarize(total_grupos = n()) %>%
drop_na(grupo) %>%
group_by(estado) %>%
summarize(total_grupos = n()) %>%
bind_rows(estados_faltan) %>%
mutate(region = str_sub(estado, -2, -1))
df_grupos <- df_gc_full %>%
# variables de interés
select(estado, grupo) %>%
group_by(estado, grupo) %>%
summarize(total_grupos = n()) %>%
drop_na(grupo) %>%
group_by(estado) %>%
summarize(total_grupos = n()) %>%
bind_rows(estados_faltan) %>%
mutate(region = str_sub(estado, -2, -1)) %>%
left_join(mxstate.map)
# mapa
ggplot(
# Datos
df_grupos,
# Coordenadas
aes(long, lat, group = group, fill = total_grupos)) +
coord_map() +
geom_polygon(color = "black", size = .2, show.legend = T, alpha = 1) +
labs(title = "Presencia criminal en México",
subtitle = "Entre julio, agosto y septiembre del 2022\n",
fill = "Número",
caption = "Fuente: Monitor-PPD (2022)") +
theme(axis.line = element_blank(),
axis.ticks = element_blank(),
axis.text = element_blank(),
axis.title = element_blank(),
panel.background = element_rect(fill = "white",
colour = NA))
ggsave(file = paste_fig("map_grupos.png"), width = 10, height = 6)
View(df_gc_full)
df_grupos <- df_gc_full %>%
# variables de interés
select(estado, grupo) %>%
group_by(estado, grupo) %>%
summarize(total_grupos = n()) %>%
drop_na(grupo) %>%
group_by(estado) %>%
summarize(total_grupos = n()) %>%
bind_rows(estados_faltan) %>%
mutate(region = str_sub(estado, -2, -1))
df_autoridad <- df_crudo %>%
select(Estado                    = estado,
Fuerzas_Armadas           = militar,
Instituciones_seguridad   = civil)
View(df_autoridad)
df_autoridad <- df_crudo %>%
select(Estado                    = estado,
Fuerzas_Armadas           = militar,
Instituciones_seguridad   = civil) %>%
group_by(Estado, Fuerzas_Armadas, Instituciones_seguridad)
df_autoridad <- df_crudo %>%
select(estado, militar, civil)
df_fa <- df_autoridad %>%
select(!civil)
View(df_fa)
df_fa <- df_autoridad %>%
select(!civil) %>%
drop_na(militar)
df_fa <- df_autoridad %>%
select(!civil) %>%
drop_na()
df_fa <- df_autoridad %>%
select(!civil) %>%
drop_na() %>%
group_by(estado) %>%
summarize(total_grupos = n())
df_fa <- df_autoridad %>%
select(!civil) %>%
drop_na()
df_civil <- df_autoridad %>%
select(!militar) %>%
drop_na()
View(df_civil)
df_autoridad <- df_crudo %>%
select(estado, militar, civil) %>%
drop_na()
df_autoridad <- df_crudo %>%
select(estado, militar, civil)
View(df_autoridad)
df_autoridad <- df_crudo %>%
select(estado,
militar, militar_a,
civil, civil_a)
df_fa <- df_autoridad %>%
select(!civil) %>%
drop_na()
df_civil <- df_autoridad %>%
select(!militar) %>%
drop_na()
df_civil <- df_autoridad %>%
select(civil, civil_a) %>%
drop_na()
df_fa <- df_autoridad %>%
select(militar, militar_a) %>%
drop_na()
df_fa <- df_autoridad %>%
select(estado, militar, militar_a) %>%
drop_na()
df_civil <- df_autoridad %>%
select(estado, civil, civil_a) %>%
drop_na()
df_fa <- df_autoridad %>%
select(estado, militar) %>%
drop_na() %>%
mutate(militar = case_when(
militar  == "GN"  ~ "militar"))
df_fa <- df_autoridad %>%
select(estado, militar) %>%
drop_na() %>%
mutate(militar = case_when(
militar  == "GN"  ~ "militar"))
df_fa <- df_autoridad %>%
select(estado, militar) %>%
drop_na()
df_fa <- df_autoridad %>%
select(estado, militar) %>%
drop_na() %>%
mutate(militar = case_when(
militar  == "GN"  ~ "militar",
militar  ==  militar ~ "militar" ))
df_autoridad <- df_crudo %>%
select(estado,
militar, civil)
df_fa <- df_autoridad %>%
select(estado, militar) %>%
drop_na() %>%
mutate(militar = "militar") %>%
distinct()
df_fa <- df_autoridad %>%
select(estado, militar) %>%
drop_na()
df_civil <- df_autoridad %>%
select(estado, civil) %>%
drop_na()
df_autoridad <- df_crudo %>%
select(estado,
militar, civil)
x <- "f"
is.na(x)
is.na(!x)
is.na(x)
df_autoridad <- df_crudo %>%
select(estado,
militar, civil) %>%
mutate(ambas = ifelse(
is.na(militar), 0, 1))
df_autoridad <- df_crudo %>%
select(estado,
militar, civil) %>%
mutate(ambas = ifelse(
is.na(militar) | is.na(civil), 0, 1))
# 6. Autoridad-----------------------------------------------------------------
df_autoridad <- df_crudo %>%
select(estado,
militar, civil) %>%
mutate(ambas = ifelse(
is.na(militar) | is.na(civil), 0, 1)) %>%
mutate(militar = case_when(
ambas == 1 ~ NA_integer_,
!is.na(militar) ~ 1))
df_autoridad <- df_crudo %>%
select(estado,
militar, civil) %>%
mutate(ambas = ifelse(
is.na(militar) | is.na(civil), 0, 1)) %>%
mutate(militar = case_when(
ambas == 1 ~ NA_integer_,
!is.na(militar) ~ 1))
df_autoridad <- df_crudo %>%
select(estado,
militar, civil) %>%
mutate(ambas = ifelse(
is.na(militar) | is.na(civil), 0, 1)) %>%
mutate(militar = case_when(
ambas == 1 ~ NA_character_,
!is.na(militar) ~ "1"))
df_autoridad <- df_crudo %>%
select(estado,
militar, civil) %>%
mutate(ambas = ifelse(
is.na(militar) | is.na(civil), 0, 1)) %>%
mutate(militar = case_when(
ambas == 1 ~ NA_character_,
!is.na(militar) ~ "1")) %>%
mutate(civil = case_when(
ambas == 1 ~ NA_character_,
!is.na(civil) ~ "1"))
df_autoridad <- df_crudo %>%
select(estado,
militar, civil) %>%
mutate(ambas = ifelse(
is.na(militar) | is.na(civil), 0, 1)) %>%
mutate(militar = case_when(
ambas == 1 ~ NA_character_,
!is.na(militar) ~ "1")) %>%
mutate(civil = case_when(
ambas == 1 ~ NA_character_,
!is.na(civil) ~ "1")) %>%
mutate(militar = as.numeric(militar),
civil   = as.numeric(civil)) %>%
group_by(estado) %>%
summarise_all(~ sum(., na.rm = T))
df_autoridad <- df_crudo %>%
select(estado,
militar, civil) %>%
mutate(ambas = ifelse(
is.na(militar) | is.na(civil), 0, 1)) %>%
mutate(militar = case_when(
ambas == 1 ~ NA_character_,
!is.na(militar) ~ "1")) %>%
mutate(civil = case_when(
ambas == 1 ~ NA_character_,
!is.na(civil) ~ "1")) %>%
mutate(militar = as.numeric(militar),
civil   = as.numeric(civil)) %>%
group_by(estado) %>%
summarise_all(~ sum(., na.rm = T)) %>%
drop_na(estado)
sum(df_autoridad$militar)
7*100/256
t_tip_auto <- df_autoridad %>%
mutate(militar = militar/sum(militar)*100)
View(t_tip_auto)
t_tip_auto <- df_autoridad %>%
mutate(militar = militar/sum(militar))
t_tip_auto <- df_autoridad %>%
mutate(militar = militar/sum(militar)) %>%
mutate(civil   = civil/sum(civil)) %>%
mutate(ambas   = ambas/sum(ambas))
t_tip_auto <- df_autoridad %>%
mutate(militar = militar/sum(militar)) %>%
mutate(civil   = civil/sum(civil))     %>%
mutate(ambas   = ambas/sum(ambas))     %>%
mutate(militar = scales::percent(militar),
civil   = scales::percent(civil),
ambas   = scales::percent(ambas))
t_tip_estado <- df_autoridad %>%
mutate(total = militar + civil + ambas)
View(t_tip_estado)
t_tip_estado <- df_autoridad %>%
mutate(total = militar + civil + ambas) %>%
mutate(militar = militar/total,
civil   = civil/total,
ambas   = ambas/total,
militar = scales::percent(militar),
civil   = scales::percent(civil),
ambas   = scales::percent(ambas))
t_tip_estado <- df_autoridad %>%
mutate(total = rowSums(militar, civil, ambas, na.rm = T)) %>%
mutate(militar = militar/total,
civil   = civil/total,
ambas   = ambas/total,
militar = scales::percent(militar),
civil   = scales::percent(civil),
ambas   = scales::percent(ambas))
df_autoridad <- df_crudo %>%
select(estado,
militar, civil) %>%
mutate(ambas = ifelse(
is.na(militar) | is.na(civil), 0, 1)) %>%
mutate(militar = case_when(
ambas == 1 ~ NA_character_,
!is.na(militar) ~ "1")) %>%
mutate(civil = case_when(
ambas == 1 ~ NA_character_,
!is.na(civil) ~ "1")) %>%
mutate(militar = as.numeric(militar),
civil   = as.numeric(civil)) %>%
group_by(estado) %>%
summarise_all(~ sum(., na.rm = T)) %>%
drop_na(estado)
# En el caso donde están las dos autoridades en un mismo eventos, no se se les
# suma de manera individual.
# Total = todas las intervenciones de un tipo de autoridad (militar, civil) país
t_tip_auto <- df_autoridad %>%
mutate(militar = militar/sum(militar)) %>%
mutate(civil   = civil/sum(civil))     %>%
mutate(ambas   = ambas/sum(ambas))     %>%
mutate(militar = scales::percent(militar),
civil   = scales::percent(civil),
ambas   = scales::percent(ambas))
# Total = todas las intervenciones de todas autoridades en un estado
t_tip_estado <- df_autoridad %>%
mutate(total =  militar + civil + ambas) %>%
mutate(militar = militar/total,
civil   = civil/total,
ambas   = ambas/total,
militar = scales::percent(militar),
civil   = scales::percent(civil),
ambas   = scales::percent(ambas))
t_tip_estado <- df_autoridad %>%
mutate(total =  militar + civil + ambas) %>%
mutate(militar = militar/total,
civil   = civil/total,
ambas   = ambas/total)
t_tip_estado <- df_autoridad %>%
mutate(total =  militar + civil + ambas)
t_tip_estado <- df_autoridad %>%
mutate(total =  militar + civil + ambas) %>%
mutate(militar = militar/total,
civil   = civil/total,
ambas   = ambas/total,
militar = scales::percent(militar),
civil   = scales::percent(civil),
ambas   = scales::percent(ambas))
t_tip_estado <- df_autoridad %>%
mutate(total =  militar + civil + ambas) %>%
mutate(militar = militar/total,
civil   = civil/total,
ambas   = ambas/total,
militar = scales::percent(militar),
civil   = scales::percent(civil),
ambas   = scales::percent(ambas)) %>%
drop_na()
t_tip_estado <- df_autoridad %>%
mutate(total =  militar + civil + ambas) %>%
mutate(militar = militar/total,
civil   = civil/total,
ambas   = ambas/total,
militar = scales::percent(militar),
civil   = scales::percent(civil),
ambas   = scales::percent(ambas))
t_tip_estado <- df_autoridad %>%
mutate(total =  militar + civil + ambas) %>%
mutate(militar = militar/total,
civil   = civil/total,
ambas   = ambas/total,
militar = scales::percent(militar, accuracy = 0.1),
civil   = scales::percent(civil),
ambas   = scales::percent(ambas))
t_tip_estado <- df_autoridad %>%
mutate(total =  militar + civil + ambas) %>%
mutate(militar = militar/total,
civil   = civil/total,
ambas   = ambas/total,
militar = scales::percent(militar, accuracy = 0.1),
civil   = scales::percent(civil, accuracy = 0.1),
ambas   = scales::percent(ambas, accuracy = 0.1))
t_tip_estado <- df_autoridad %>%
mutate(total =  militar + civil + ambas) %>%
mutate(militar = militar/total,
civil   = civil/total,
ambas   = ambas/total,
militar = scales::percent(militar, accuracy = 0.1),
civil   = scales::percent(civil, accuracy = 0.1),
ambas   = scales::percent(ambas, accuracy = 0.1)) %>%
select(!total)
t_tip_estado <- df_autoridad %>%
mutate(total =  militar + civil + ambas) %>%
mutate(militar = militar/total,
civil   = civil/total,
ambas   = ambas/total,
militar = scales::percent(militar, accuracy = 0.1),
civil   = scales::percent(civil, accuracy = 0.1),
ambas   = scales::percent(ambas, accuracy = 0.1)) %>%
select(!total) %>%
mutate(estado = str_sub(estado, -2, -1))
t_tip_estado <- df_autoridad %>%
mutate(total =  militar + civil + ambas) %>%
mutate(militar = militar/total,
civil   = civil/total,
ambas   = ambas/total,
militar = scales::percent(militar, accuracy = 0.1),
civil   = scales::percent(civil, accuracy = 0.1),
ambas   = scales::percent(ambas, accuracy = 0.1)) %>%
select(!total)
t_tip_estado <- df_autoridad %>%
mutate(total =  militar + civil + ambas) %>%
mutate(militar = militar/total,
civil   = civil/total,
ambas   = ambas/total,
militar = scales::percent(militar, accuracy = 0.1),
civil   = scales::percent(civil, accuracy = 0.1),
ambas   = scales::percent(ambas, accuracy = 0.1)) %>%
select(!total) %>%
mutate(estado = str_sub(estado, 0, -1))
t_tip_estado <- df_autoridad %>%
mutate(total =  militar + civil + ambas) %>%
mutate(militar = militar/total,
civil   = civil/total,
ambas   = ambas/total,
militar = scales::percent(militar, accuracy = 0.1),
civil   = scales::percent(civil, accuracy = 0.1),
ambas   = scales::percent(ambas, accuracy = 0.1)) %>%
select(!total) %>%
mutate(estado = str_sub(estado, 0, -5))
# Total = todas las intervenciones de todas autoridades en un estado
t_tip_estado <- df_autoridad %>%
mutate(total =  militar + civil + ambas) %>%
mutate(militar = militar/total,
civil   = civil/total,
ambas   = ambas/total,
militar = scales::percent(militar, accuracy = 0.1),
civil   = scales::percent(civil, accuracy = 0.1),
ambas   = scales::percent(ambas, accuracy = 0.1)) %>%
select(!total) %>%
mutate(estado = str_sub(estado, 0, -7))
t_tip_estado <- df_autoridad %>%
mutate(total =  militar + civil + ambas) %>%
mutate(militar = militar/total,
civil   = civil/total,
ambas   = ambas/total,
militar = scales::percent(militar, accuracy = 0.1),
civil   = scales::percent(civil, accuracy = 0.1),
ambas   = scales::percent(ambas, accuracy = 0.1)) %>%
select(!total) %>%
mutate(estado = str_sub(estado, 0, -10))
t_tip_estado <- df_autoridad %>%
mutate(total =  militar + civil + ambas) %>%
mutate(militar = militar/total,
civil   = civil/total,
ambas   = ambas/total,
militar = scales::percent(militar, accuracy = 0.1),
civil   = scales::percent(civil, accuracy = 0.1),
ambas   = scales::percent(ambas, accuracy = 0.1)) %>%
select(!total) %>%
mutate(estado = str_sub(estado, 1, -3))
t_tip_estado <- df_autoridad %>%
mutate(total =  militar + civil + ambas) %>%
mutate(militar = militar/total,
civil   = civil/total,
ambas   = ambas/total,
militar = scales::percent(militar, accuracy = 0.1),
civil   = scales::percent(civil, accuracy = 0.1),
ambas   = scales::percent(ambas, accuracy = 0.1)) %>%
select(!total) %>%
mutate(estado = str_sub(estado, 1, -4))
t_tip_auto <- df_autoridad %>%
mutate(militar = militar/sum(militar)) %>%
mutate(civil   = civil/sum(civil))     %>%
mutate(ambas   = ambas/sum(ambas))     %>%
mutate(militar = scales::percent(militar, accuracy = 0.1),
civil   = scales::percent(civil, accuracy = 0.1),
ambas   = scales::percent(ambas, accuracy = 0.1)) %>%
mutate(estado = str_sub(estado, 1, -4))
# Total = todas las intervenciones de todas autoridades en un estado
t_tip_estado <- df_autoridad %>%
mutate(total =  militar + civil + ambas) %>%
mutate(militar = militar/total,
civil   = civil/total,
ambas   = ambas/total,
militar = scales::percent(militar, accuracy = 0.1),
civil   = scales::percent(civil, accuracy = 0.1),
ambas   = scales::percent(ambas, accuracy = 0.1)) %>%
select(!total) %>%
mutate(estado = str_sub(estado, 1, -4))
