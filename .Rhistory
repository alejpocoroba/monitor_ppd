"cuerpo_modo4"))
View(df_2)
View(df_2)
#------------------------------------------------------------------------------#
# Proyecto:                   Monitor PPD 2023
# Objetivo:                   Limpieza M-2023
#
# Encargado:                  Alejandro Pocoroba y Erick Isaac Morales Sánchez
# Correo:                     alejandro.pocoroba@cide.edu
# Fecha de creación:          01 de mayo de 2023
# Última actualización:       02 de mayo de 2023
#------------------------------------------------------------------------------#
# Fuente: Monitor PPD versión 2023
# 0. Configuración inicial -----------------------------------------------------
# Silenciar mensajes de .group en dplyr
options(dplyr.summarise.inform = FALSE)
# Librerías
require(pacman)
p_load(
readxl, tidyverse, dplyr, srvyr, zoo, ggtext, beepr)
# Limpiar espacio de trabajo
rm(list=ls())
# Funciones con direcciones de las carpetas
paste_inp <- function(x){paste0("02_datos_crudos/" , x)}
paste_out <- function(x){paste0("03_datos_limpios/", x)}
paste_fig <- function(x){paste0("04_figuras/"      , x)}
# 1. Cargar datos --------------------------------------------------------------
# bases de enero, febrer y marzo
a <- read_xlsx(paste_inp("Monitor_PPD_01_02.23.xlsx"))
b <- read_xlsx(paste_inp("Monitor_PPD_03.23.xlsx"))
# Se unen bases
m1 <- a %>% bind_rows(b)
# 2. Procesamiento -------------------------------------------------------------
# Limpiar nombres de microdatos
df_ <- m1 %>%
janitor::clean_names()
# Tratamiento de fechas #
df_$"x1_2_1_fecha_publicacion" <- as.Date(df_$"x1_2_1_fecha_publicacion")
df_$dia <- format(df_$"x1_2_1_fecha_publicacion", "%d")
df_$mes <- format(df_$"x1_2_1_fecha_publicacion", "%m")
df_$anio <- format(df_$"x1_2_1_fecha_publicacion", "%Y")
# Estado y munici´pio según su clave de Inegi
df_ <- separate(df_, "x1_3_2_estado", c("estado", "clave"), sep = "-")
df_ <- separate(df_, "x1_3_3_municipio", c("municipio", "claveEdo", "clavemun"), sep = "-")
df_ <- subset(df_, select = -c(clave))
df_$clavefinal <- paste0(df_$claveEdo, df_$clavemun)
# Orden y renombrar las variables
df_1 <- df_ %>%
select("fecha_de_publicacion"   = "x1_2_1_fecha_publicacion",
"Mes"                    = "mes",
"Dia"                    = "dia",
"Anio"                   = "anio",
"fecha_hechos"           = "x1_3_1_fecha_hechos",
"Enlace"                 = "x1_2_2_enlace",
"titulo_de_la_nota"      = "x1_2_3_titulo_nota",
"nombre_de_la_fuente"    = "x1_2_4_fuente",
"enlace_otras_notas"     = "x1_2_5_enlaces_duplicados",
"Estado"                 = "estado",
"Municipio"              = "municipio",
"CVEGEO_ent"             = "claveEdo",
"CVEGEO_mun"             = "clavemun",
"CVEGEO"                 = "clavefinal",
"Lugar"                  = "x1_3_4_lugar",
"grupo_criminal"         = "x3_3_grupo_criminal",
"Alianza"                = "x3_3_1_alianza_grupo",
"Rival"                  = "x3_3_2_rival_grupo",
"Narcomensaje"           = "x3_2_1_narcomensaje",
"contenido_narcomensaje" = "x3_2_2_contenido_narcomensaje",
"homic_total"            = "x2_2_1_homicidios_total",
"homic_hombre"           = "x2_2_2_homicidios_hombre",
"homic_mujer"            = "x2_2_3_homicidios_mujer",
"homic_clasif1"          = "x2_2_4_pertenece_homicidio",
"cuerpos_localizados"    = "x2_2_5_cuerpo_restos",
"cuerpos_modo1"          = "x2_2_6_cuerpo_restos_localizados",
"cuerpos_lugar1"         = "x2_2_7_lugar_cuerpo_restos",
"heridos_total"          = "x2_3_1_heridxs_total",
"heridos_hombre"         = "x2_3_2_heridos_hombres",
"heridos_mujeres"        = "x2_3_3_heridas_mujeres",
"heridos_clasif1"        = "x2_3_4_pertenece_heridx",
"ataque_armado_clean"    = "x2_1_1_ataque",
"lugar_ataque_clean"     = "x2_1_2_lugar_ataque",
"politica_de_seguridad"  = "politica_seguridad")
# 3. Limpiar de las variables -------------------------------------------------
# Ataque
# Lugar
# Persona (homicidios + heridxs)
# Cambiar FALSE/TRUE por 0 y 1 en Narcomensajes, Cuerpos y Poli de Seg
# Narcomensaje
df_1$Narcomensaje <- as.character(df_1$Narcomensaje)
df_1 <- df_1 %>%
mutate(Narcomensaje =
case_when(Narcomensaje == "FALSE" ~ "0",
Narcomensaje == "TRUE"  ~ "1",
Narcomensaje == Narcomensaje ~ Narcomensaje))
# Cuerpos
df_1$cuerpos_localizados <- as.character(df_1$cuerpos_localizados)
df_1 <- df_1 %>%
mutate(cuerpos_localizados =
case_when(cuerpos_localizados == "FALSE" ~ "0",
cuerpos_localizados == "TRUE"  ~ "1",
cuerpos_localizados == cuerpos_localizados ~ cuerpos_localizados))
# Politica de seguridad
df_1$politica_de_seguridad <- as.character(df_1$politica_de_seguridad)
df_1 <- df_1 %>%
mutate(politica_de_seguridad =
case_when(politica_de_seguridad == "FALSE" ~ "0",
politica_de_seguridad == "TRUE"  ~ "1",
politica_de_seguridad == politica_de_seguridad ~ politica_de_seguridad))
# Cuerpos
df_1 <- df_1 %>%
mutate(cuerpos_modo1 = str_replace_all(cuerpos_modo1, ":", ";")) %>%
separate(cuerpos_modo1, sep = ";", c("cuerpo_modo1",
"cuerpo_modo2"))
a <- read_xlsx(paste_inp("Monitor_PPD_01_02.23.xlsx"))
b <- read_xlsx(paste_inp("Monitor_PPD_03.23.xlsx"))
# Se unen bases
m1 <- a %>% bind_rows(b)
# 0. Configuración inicial -----------------------------------------------------
# Silenciar mensajes de .group en dplyr
options(dplyr.summarise.inform = FALSE)
# Librerías
require(pacman)
p_load(
readxl, tidyverse, dplyr, srvyr, zoo, ggtext, beepr)
# Limpiar espacio de trabajo
rm(list=ls())
# Funciones con direcciones de las carpetas
paste_inp <- function(x){paste0("02_datos_crudos/" , x)}
paste_out <- function(x){paste0("03_datos_limpios/", x)}
paste_fig <- function(x){paste0("04_figuras/"      , x)}
# 1. Cargar datos --------------------------------------------------------------
# bases de enero, febrer y marzo
a <- read_xlsx(paste_inp("Monitor_PPD_01_02.23.xlsx"))
b <- read_xlsx(paste_inp("Monitor_PPD_03.23.xlsx"))
# Se unen bases
m1 <- a %>% bind_rows(b)
a <- read_xlsx(paste_inp("Monitor_PPD_01_02.23.xlsx"))
b <- read_xlsx(paste_inp("Monitor_PPD_03.23.xlsx"))
paste_inp <- function(x){paste0("02_datos_crudos/" , x)}
paste_out <- function(x){paste0("03_datos_limpios/", x)}
paste_fig <- function(x){paste0("04_figuras/"      , x)}
a <- read_xlsx(paste_inp("Monitor_PPD_01_02.23.xlsx"))
b <- read_xlsx(paste_inp("Monitor_PPD_03.23.xlsx"))
m1 <- a %>% bind_rows(b)
df_ <- m1 %>%
janitor::clean_names()
View(df_)
# Tratamiento de fechas #
df_$"x1_2_1_fecha_publicacion" <- as.Date(df_$"x1_2_1_fecha_publicacion")
df_$dia <- format(df_$"x1_2_1_fecha_publicacion", "%d")
df_$mes <- format(df_$"x1_2_1_fecha_publicacion", "%m")
df_$anio <- format(df_$"x1_2_1_fecha_publicacion", "%Y")
# Estado y munici´pio según su clave de Inegi
df_ <- separate(df_, "x1_3_2_estado", c("estado", "clave"), sep = "-")
df_ <- separate(df_, "x1_3_3_municipio", c("municipio", "claveEdo", "clavemun"), sep = "-")
df_ <- subset(df_, select = -c(clave))
df_$clavefinal <- paste0(df_$claveEdo, df_$clavemun)
df_1 <- df_ %>%
select("fecha_de_publicacion"   = "x1_2_1_fecha_publicacion",
"Mes"                    = "mes",
"Dia"                    = "dia",
"Anio"                   = "anio",
"fecha_hechos"           = "x1_3_1_fecha_hechos",
"Enlace"                 = "x1_2_2_enlace",
"titulo_de_la_nota"      = "x1_2_3_titulo_nota",
"nombre_de_la_fuente"    = "x1_2_4_fuente",
"enlace_otras_notas"     = "x1_2_5_enlaces_duplicados",
"Estado"                 = "estado",
"Municipio"              = "municipio",
"CVEGEO_ent"             = "claveEdo",
"CVEGEO_mun"             = "clavemun",
"CVEGEO"                 = "clavefinal",
"Lugar"                  = "x1_3_4_lugar",
"grupo_criminal"         = "x3_3_grupo_criminal",
"Alianza"                = "x3_3_1_alianza_grupo",
"Rival"                  = "x3_3_2_rival_grupo",
"Narcomensaje"           = "x3_2_1_narcomensaje",
"contenido_narcomensaje" = "x3_2_2_contenido_narcomensaje",
"homic_total"            = "x2_2_1_homicidios_total",
"homic_hombre"           = "x2_2_2_homicidios_hombre",
"homic_mujer"            = "x2_2_3_homicidios_mujer",
"homic_clasif1"          = "x2_2_4_pertenece_homicidio",
"cuerpos_localizados"    = "x2_2_5_cuerpo_restos",
"cuerpos_modo1"          = "x2_2_6_cuerpo_restos_localizados",
"cuerpos_lugar1"         = "x2_2_7_lugar_cuerpo_restos",
"heridos_total"          = "x2_3_1_heridxs_total",
"heridos_hombre"         = "x2_3_2_heridos_hombres",
"heridos_mujeres"        = "x2_3_3_heridas_mujeres",
"heridos_clasif1"        = "x2_3_4_pertenece_heridx",
"ataque_armado_clean"    = "x2_1_1_ataque",
"lugar_ataque_clean"     = "x2_1_2_lugar_ataque",
"politica_de_seguridad"  = "politica_seguridad")
View(df_1)
df_1$Narcomensaje <- as.character(df_1$Narcomensaje)
df_1 <- df_1 %>%
mutate(Narcomensaje =
case_when(Narcomensaje == "FALSE" ~ "0",
Narcomensaje == "TRUE"  ~ "1",
Narcomensaje == Narcomensaje ~ Narcomensaje))
# Cuerpos
df_1$cuerpos_localizados <- as.character(df_1$cuerpos_localizados)
df_1 <- df_1 %>%
mutate(cuerpos_localizados =
case_when(cuerpos_localizados == "FALSE" ~ "0",
cuerpos_localizados == "TRUE"  ~ "1",
cuerpos_localizados == cuerpos_localizados ~ cuerpos_localizados))
# Politica de seguridad
df_1$politica_de_seguridad <- as.character(df_1$politica_de_seguridad)
df_1 <- df_1 %>%
mutate(politica_de_seguridad =
case_when(politica_de_seguridad == "FALSE" ~ "0",
politica_de_seguridad == "TRUE"  ~ "1",
politica_de_seguridad == politica_de_seguridad ~ politica_de_seguridad))
#------------------------------------------------------------------------------#
# Proyecto:                   Monitor PPD 2023
# Objetivo:                   Limpieza M-2023
#
# Encargado:                  Alejandro Pocoroba y Erick Isaac Morales Sánchez
# Correo:                     alejandro.pocoroba@cide.edu
# Fecha de creación:          01 de mayo de 2023
# Última actualización:       02 de mayo de 2023
#------------------------------------------------------------------------------#
# Fuente: Monitor PPD versión enero-marzo 2023
# 0. Configuración inicial -----------------------------------------------------
# Silenciar mensajes de .group en dplyr
options(dplyr.summarise.inform = FALSE)
# Librerías
require(pacman)
p_load(
readxl, tidyverse, dplyr, srvyr, zoo, ggtext, beepr)
# Limpiar espacio de trabajo
rm(list=ls())
# Funciones con direcciones de las carpetas
paste_inp <- function(x){paste0("02_datos_crudos/" , x)}
paste_out <- function(x){paste0("03_datos_limpios/", x)}
paste_fig <- function(x){paste0("04_figuras/"      , x)}
# 1. Cargar datos --------------------------------------------------------------
# bases de enero, febrer y marzo
a <- read_xlsx(paste_inp("Monitor_PPD_01_02.23.xlsx"))
b <- read_xlsx(paste_inp("Monitor_PPD_03.23.xlsx"))
# Se unen bases
m1 <- a %>% bind_rows(b)
# 2. Procesamiento -------------------------------------------------------------
# Limpiar nombres de microdatos
df_ <- m1 %>%
janitor::clean_names()
# Tratamiento de fechas #
df_$"x1_2_1_fecha_publicacion" <- as.Date(df_$"x1_2_1_fecha_publicacion")
df_$dia <- format(df_$"x1_2_1_fecha_publicacion", "%d")
df_$mes <- format(df_$"x1_2_1_fecha_publicacion", "%m")
df_$anio <- format(df_$"x1_2_1_fecha_publicacion", "%Y")
# Estado y munici´pio según su clave de Inegi
df_ <- separate(df_, "x1_3_2_estado", c("estado", "clave"), sep = "-")
df_ <- separate(df_, "x1_3_3_municipio", c("municipio", "claveEdo", "clavemun"), sep = "-")
df_ <- subset(df_, select = -c(clave))
df_$clavefinal <- paste0(df_$claveEdo, df_$clavemun)
# Orden y renombrar las variables
df_1 <- df_ %>%
select("fecha_de_publicacion"   = "x1_2_1_fecha_publicacion",
"Mes"                    = "mes",
"Dia"                    = "dia",
"Anio"                   = "anio",
"fecha_hechos"           = "x1_3_1_fecha_hechos",
"Enlace"                 = "x1_2_2_enlace",
"titulo_de_la_nota"      = "x1_2_3_titulo_nota",
"nombre_de_la_fuente"    = "x1_2_4_fuente",
"enlace_otras_notas"     = "x1_2_5_enlaces_duplicados",
"Estado"                 = "estado",
"Municipio"              = "municipio",
"CVEGEO_ent"             = "claveEdo",
"CVEGEO_mun"             = "clavemun",
"CVEGEO"                 = "clavefinal",
"Lugar"                  = "x1_3_4_lugar",
"grupo_criminal"         = "x3_3_grupo_criminal",
"Alianza"                = "x3_3_1_alianza_grupo",
"Rival"                  = "x3_3_2_rival_grupo",
"Narcomensaje"           = "x3_2_1_narcomensaje",
"contenido_narcomensaje" = "x3_2_2_contenido_narcomensaje",
"homic_total"            = "x2_2_1_homicidios_total",
"homic_hombre"           = "x2_2_2_homicidios_hombre",
"homic_mujer"            = "x2_2_3_homicidios_mujer",
"homic_clasif1"          = "x2_2_4_pertenece_homicidio",
"cuerpos_localizados"    = "x2_2_5_cuerpo_restos",
"cuerpos_modo1"          = "x2_2_6_cuerpo_restos_localizados",
"cuerpos_lugar1"         = "x2_2_7_lugar_cuerpo_restos",
"heridos_total"          = "x2_3_1_heridxs_total",
"heridos_hombre"         = "x2_3_2_heridos_hombres",
"heridos_mujeres"        = "x2_3_3_heridas_mujeres",
"heridos_clasif1"        = "x2_3_4_pertenece_heridx",
"ataque_armado_clean"    = "x2_1_1_ataque",
"lugar_ataque_clean"     = "x2_1_2_lugar_ataque",
"politica_de_seguridad"  = "politica_seguridad")
# 3. Limpiar de las variables -------------------------------------------------
# Ataque
# Lugar
# Persona (homicidios + heridxs)
# Cambiar FALSE/TRUE por 0 y 1 en Narcomensajes, Cuerpos y Poli de Seg
# Narcomensaje
df_1$Narcomensaje <- as.character(df_1$Narcomensaje)
df_1 <- df_1 %>%
mutate(Narcomensaje =
case_when(Narcomensaje == "FALSE" ~ "0",
Narcomensaje == "TRUE"  ~ "1",
Narcomensaje == Narcomensaje ~ Narcomensaje))
# Cuerpos
df_1$cuerpos_localizados <- as.character(df_1$cuerpos_localizados)
df_1 <- df_1 %>%
mutate(cuerpos_localizados =
case_when(cuerpos_localizados == "FALSE" ~ "0",
cuerpos_localizados == "TRUE"  ~ "1",
cuerpos_localizados == cuerpos_localizados ~ cuerpos_localizados))
# Politica de seguridad
df_1$politica_de_seguridad <- as.character(df_1$politica_de_seguridad)
df_1 <- df_1 %>%
mutate(politica_de_seguridad =
case_when(politica_de_seguridad == "FALSE" ~ "0",
politica_de_seguridad == "TRUE"  ~ "1",
politica_de_seguridad == politica_de_seguridad ~ politica_de_seguridad))
df_1 <- df_1 %>%
mutate(cuerpos_modo1 = str_replace_all(cuerpos_modo1, ":", ";")) %>%
separate(cuerpos_modo1, sep = ";", c("cuerpo_modo1",
"cuerpo_modo2"))
v_armadefuego <- c("huellas de tortura/ impacto de armas de fuego", "Impactos de arma de fuego",
"Huellas de tortura / cuerpo maniatado", "impactos de arma de fuego; bolsa de plástico",
"impacto de arma de fuego; maniatado", "maniatado; impactos de bala", "impactos de arma de fuego; tortura",
"impactos de arma de fuego; calcinado")
v_tortura_maniatado <- c("maniatado", "Huellas de violencia; soga en el cuello", "huellas de violencia",
"colgado", "huellas de tortura; calcinado", "lesión en el cuello", "colgado; golpes", "ahorcado", "maniatado; encobijado")
v_plastico_encobijado <- c("envuelto en una lona", "Bolsas de plástico / encobijado",
"bolsas de plástico", "encobijado", "Tambo de agua, bolsa de plastico, huellas de violencia",
"estrangulado; encobijado", "bolsas de plástico; cuerpos en descomposición", "huellas de violencia; bolsa de plastico",
"bolsa de plástico; maniatado")
v_descomposicion <- c("restos óseos", "Osamenta", "Descomposición / restos óseos / enterrado / fosas", "restos humanos", "Descomposición",
"bolsa de plástico; fosa")
v_calcinado <- c("Calcinado")
v_desmembrado <- c("Desmembrado / alguna parte del cuerpo", "decapitado", "degollada",
"desmembrado", "desmembrado; bolsa de plástico", "cabeza", "pie", "degollado", "desmembrado; encobijado", "maleta")
v_otro <- c("golpes", "encajuelados", "enterrado", "cubierto con material",
"golpe en la cabeza", "arma blanca", "Otro", "estrangulado",
"Heridas arma blanca", "Tambo de agua")
v_sinformación <- c("ojos vendados", "sin información", "cuerpo completo")
df_1 <- df_1 %>%
mutate(cuerpos_modo1 =
case_when(cuerpos_modo1 %in% v_armadefuego          ~ "Impactos de arma de fuego",
cuerpos_modo1 %in% v_tortura_maniatado    ~ "Huellas de tortura / cuerpo maniatado",
cuerpos_modo1 %in% v_plastico_encobijado  ~ "Bolsas de plástico / encobijado",
cuerpos_modo1 %in% v_descomposicion       ~ "Descomposición / restos óseos / enterrado / fosas",
cuerpos_modo1 %in% v_calcinado            ~ "Calcinado",
cuerpos_modo1 %in% v_desmembrado          ~ "Desmembrado / alguna parte del cuerpo",
cuerpos_modo1 %in% v_otro                 ~ "Otro",
cuerpos_modo1 %in% v_sinformación         ~ "Sin información",
cuerpos_modo1 == cuerpos_modo1 ~ cuerpos_modo1))
v_ataque <- c("arma blanca", "asalto con arma blanca", "asfixia",
"degollación",  "lapidación")
colnames(df_1)
df_3 <- df_1 %>%
mutate(ataque_armado_clean =
case_when(ataque_armado_clean %in% v_ataque    ~ "agresión con arma blanca",
ataque_armado_clean == cuerpos_modo1 ~ cuerpos_modo1))
#------------------------------------------------------------------------------#
# Proyecto:                   Monitor PPD 2023
# Objetivo:                   Limpieza M-2023
#
# Encargado:                  Alejandro Pocoroba y Erick Isaac Morales Sánchez
# Correo:                     alejandro.pocoroba@cide.edu
# Fecha de creación:          01 de mayo de 2023
# Última actualización:       02 de mayo de 2023
#------------------------------------------------------------------------------#
# Fuente: Monitor PPD versión enero-marzo 2023
# 0. Configuración inicial -----------------------------------------------------
# Silenciar mensajes de .group en dplyr
options(dplyr.summarise.inform = FALSE)
# Librerías
require(pacman)
p_load(
readxl, tidyverse, dplyr, srvyr, zoo, ggtext, beepr)
# Limpiar espacio de trabajo
rm(list=ls())
# Funciones con direcciones de las carpetas
paste_inp <- function(x){paste0("02_datos_crudos/" , x)}
paste_out <- function(x){paste0("03_datos_limpios/", x)}
paste_fig <- function(x){paste0("04_figuras/"      , x)}
# 1. Cargar datos --------------------------------------------------------------
# bases de enero, febrer y marzo
a <- read_xlsx(paste_inp("Monitor_PPD_01_02.23.xlsx"))
b <- read_xlsx(paste_inp("Monitor_PPD_03.23.xlsx"))
# Se unen bases
m1 <- a %>% bind_rows(b)
# 2. Procesamiento -------------------------------------------------------------
# Limpiar nombres de microdatos
df_ <- m1 %>%
janitor::clean_names()
# Tratamiento de fechas #
df_$"x1_2_1_fecha_publicacion" <- as.Date(df_$"x1_2_1_fecha_publicacion")
df_$dia <- format(df_$"x1_2_1_fecha_publicacion", "%d")
df_$mes <- format(df_$"x1_2_1_fecha_publicacion", "%m")
df_$anio <- format(df_$"x1_2_1_fecha_publicacion", "%Y")
# Estado y munici´pio según su clave de Inegi
df_ <- separate(df_, "x1_3_2_estado", c("estado", "clave"), sep = "-")
df_ <- separate(df_, "x1_3_3_municipio", c("municipio", "claveEdo", "clavemun"), sep = "-")
df_ <- subset(df_, select = -c(clave))
df_$clavefinal <- paste0(df_$claveEdo, df_$clavemun)
# Orden y renombrar las variables
df_1 <- df_ %>%
select("fecha_de_publicacion"   = "x1_2_1_fecha_publicacion",
"Mes"                    = "mes",
"Dia"                    = "dia",
"Anio"                   = "anio",
"fecha_hechos"           = "x1_3_1_fecha_hechos",
"Enlace"                 = "x1_2_2_enlace",
"titulo_de_la_nota"      = "x1_2_3_titulo_nota",
"nombre_de_la_fuente"    = "x1_2_4_fuente",
"enlace_otras_notas"     = "x1_2_5_enlaces_duplicados",
"Estado"                 = "estado",
"Municipio"              = "municipio",
"CVEGEO_ent"             = "claveEdo",
"CVEGEO_mun"             = "clavemun",
"CVEGEO"                 = "clavefinal",
"Lugar"                  = "x1_3_4_lugar",
"grupo_criminal"         = "x3_3_grupo_criminal",
"Alianza"                = "x3_3_1_alianza_grupo",
"Rival"                  = "x3_3_2_rival_grupo",
"Narcomensaje"           = "x3_2_1_narcomensaje",
"contenido_narcomensaje" = "x3_2_2_contenido_narcomensaje",
"homic_total"            = "x2_2_1_homicidios_total",
"homic_hombre"           = "x2_2_2_homicidios_hombre",
"homic_mujer"            = "x2_2_3_homicidios_mujer",
"homic_clasif1"          = "x2_2_4_pertenece_homicidio",
"cuerpos_localizados"    = "x2_2_5_cuerpo_restos",
"cuerpos_modo1"          = "x2_2_6_cuerpo_restos_localizados",
"cuerpos_lugar1"         = "x2_2_7_lugar_cuerpo_restos",
"heridos_total"          = "x2_3_1_heridxs_total",
"heridos_hombre"         = "x2_3_2_heridos_hombres",
"heridos_mujeres"        = "x2_3_3_heridas_mujeres",
"heridos_clasif1"        = "x2_3_4_pertenece_heridx",
"ataque_armado_clean"    = "x2_1_1_ataque",
"lugar_ataque_clean"     = "x2_1_2_lugar_ataque",
"politica_de_seguridad"  = "politica_seguridad")
# 3. Limpiar de las variables -------------------------------------------------
# Ataque
# Lugar
# Persona (homicidios + heridxs)
# Cambiar FALSE/TRUE por 0 y 1 en Narcomensajes, Cuerpos y Poli de Seg
# Narcomensaje
df_1$Narcomensaje <- as.character(df_1$Narcomensaje)
df_1 <- df_1 %>%
mutate(Narcomensaje =
case_when(Narcomensaje == "FALSE" ~ "0",
Narcomensaje == "TRUE"  ~ "1",
Narcomensaje == Narcomensaje ~ Narcomensaje))
# Cuerpos
df_1$cuerpos_localizados <- as.character(df_1$cuerpos_localizados)
df_1 <- df_1 %>%
mutate(cuerpos_localizados =
case_when(cuerpos_localizados == "FALSE" ~ "0",
cuerpos_localizados == "TRUE"  ~ "1",
cuerpos_localizados == cuerpos_localizados ~ cuerpos_localizados))
# Politica de seguridad
df_1$politica_de_seguridad <- as.character(df_1$politica_de_seguridad)
df_1 <- df_1 %>%
mutate(politica_de_seguridad =
case_when(politica_de_seguridad == "FALSE" ~ "0",
politica_de_seguridad == "TRUE"  ~ "1",
politica_de_seguridad == politica_de_seguridad ~ politica_de_seguridad))
# Cuerpos
df_1 <- df_1 %>%
mutate(cuerpos_modo1 = str_replace_all(cuerpos_modo1, ":", ";")) %>%
separate(cuerpos_modo1, sep = ";", c("cuerpo_modo1",
"cuerpo_modo2"))
df_3 <- df_1 %>%
mutate(ataque_armado_clean =
case_when(ataque_armado_clean %in% v_ataque    ~ "agresión con arma blanca",
ataque_armado_clean == ataque_armado_clean ~ ataque_armado_clean))
View(df_1)
v_ataque <- c("arma blanca", "asalto con arma blanca", "asfixia",
"degollación",  "lapidación")
df_3 <- df_1 %>%
mutate(ataque_armado_clean =
case_when(ataque_armado_clean %in% v_ataque    ~ "agresión con arma blanca",
ataque_armado_clean == ataque_armado_clean ~ ataque_armado_clean))
View(df_3)
unique(df_3$ataque_armado_clean)
v_armadefuego <- c("huellas de tortura/ impacto de armas de fuego", "Impactos de arma de fuego",
"Huellas de tortura / cuerpo maniatado", "impactos de arma de fuego; bolsa de plástico",
"impacto de arma de fuego; maniatado", "maniatado; impactos de bala", "impactos de arma de fuego; tortura",
"impactos de arma de fuego; calcinado")
v_tortura_maniatado <- c("maniatado", "Huellas de violencia; soga en el cuello", "huellas de violencia",
"colgado", "huellas de tortura; calcinado", "lesión en el cuello", "colgado; golpes", "ahorcado", "maniatado; encobijado")
v_plastico_encobijado <- c("envuelto en una lona", "Bolsas de plástico / encobijado",
"bolsas de plástico", "encobijado", "Tambo de agua, bolsa de plastico, huellas de violencia",
"estrangulado; encobijado", "bolsas de plástico; cuerpos en descomposición", "huellas de violencia; bolsa de plastico",
"bolsa de plástico; maniatado")
v_descomposicion <- c("restos óseos", "Osamenta", "Descomposición / restos óseos / enterrado / fosas", "restos humanos", "Descomposición",
"bolsa de plástico; fosa")
v_calcinado <- c("Calcinado")
v_desmembrado <- c("Desmembrado / alguna parte del cuerpo", "decapitado", "degollada",
"desmembrado", "desmembrado; bolsa de plástico", "cabeza", "pie", "degollado", "desmembrado; encobijado", "maleta")
v_otro <- c("golpes", "encajuelados", "enterrado", "cubierto con material",
"golpe en la cabeza", "arma blanca", "Otro", "estrangulado",
"Heridas arma blanca", "Tambo de agua")
v_sinformación <- c("ojos vendados", "sin información", "cuerpo completo")
df_3 <- df_1 %>%
mutate(cuerpos_modo1 =
case_when(cuerpos_modo1 %in% v_armadefuego          ~ "Impactos de arma de fuego",
cuerpos_modo1 %in% v_tortura_maniatado    ~ "Huellas de tortura / cuerpo maniatado",
cuerpos_modo1 %in% v_plastico_encobijado  ~ "Bolsas de plástico / encobijado",
cuerpos_modo1 %in% v_descomposicion       ~ "Descomposición / restos óseos / enterrado / fosas",
cuerpos_modo1 %in% v_calcinado            ~ "Calcinado",
cuerpos_modo1 %in% v_desmembrado          ~ "Desmembrado / alguna parte del cuerpo",
cuerpos_modo1 %in% v_otro                 ~ "Otro",
cuerpos_modo1 %in% v_sinformación         ~ "Sin información",
cuerpos_modo1 == cuerpos_modo1 ~ cuerpos_modo1))
