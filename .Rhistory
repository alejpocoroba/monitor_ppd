paste_out <- function(x){paste0("03_datos_limpios/", x)}
paste_inp2 <- function(x){paste0("02_datos_crudos/" , x)}
# 1. Cargar datos---------------------------------------------------------------
load(paste_inp("df_monitor_amplio.Rdata")) # junio - octubre 2022
m10 <- read_xlsx(paste_inp2("Monitor_PPD_noviembre.xlsx"))
View(df_monitor_amplio)
unique(df_monitor_amplio$actividades_delictivas)
unique(df_monitor_amplio$otras_actividades_ilicitas)
v_narcomenudeo_simple <- c("narcomenudeo", "narcomenudista")
v_narcomenudeo_delitos <- c("narcomenudeo; robo; extorsión", "robo con violencia; narcomenudeo",
"robo; homicidio; narcomenudeo; robo de vehículo",
"homicidio; desaparición; narcomenudeo",
"narcomenudeo; feminicidio", "huachicol; narcomenudeo; posesión de armas")
v_delitos_salud_delitos <- c("delitos contra la salud, robo, abuso sexual",
"delitos contra la salud; robo", "portación de arma; delitos contra la salud",
"delito de delincuencia organizada con la finalidad de cometer un delito contra la salud")
v_delitos_salud_simple <- c("delitos contra la salud")
v_posesión_sus_simple <- c("posesión de sustancias", "posesión de drogas", )
v_posesión_sus_delitos <- c("posesión de droga; posesión de arma", "robo casa habitación y a negocios; posesión de narcóticos",
"artefactos explosivos; cartuchos; vehículos; drogas ilícitas", "posesión de armas; posesión de sustancias",
"robo; posesión de sustancias")
v_narcomenudeo_simple <- c("narcomenudeo", "narcomenudista")
v_narcomenudeo_delitos <- c("narcomenudeo; robo; extorsión", "robo con violencia; narcomenudeo",
"robo; homicidio; narcomenudeo; robo de vehículo",
"homicidio; desaparición; narcomenudeo",
"narcomenudeo; feminicidio", "huachicol; narcomenudeo; posesión de armas")
v_delitos_salud_delitos <- c("delitos contra la salud, robo, abuso sexual",
"delitos contra la salud; robo", "portación de arma; delitos contra la salud",
"delito de delincuencia organizada con la finalidad de cometer un delito contra la salud")
v_delitos_salud_simple <- c("delitos contra la salud")
v_posesión_sus_simple <- c("posesión de sustancias", "posesión de drogas")
v_posesión_sus_delitos <- c("posesión de droga; posesión de arma", "robo casa habitación y a negocios; posesión de narcóticos",
"artefactos explosivos; cartuchos; vehículos; drogas ilícitas", "posesión de armas; posesión de sustancias",
"robo; posesión de sustancias")
df_detenciones <- df_monitor_amplio %>%
mutate(otras_actividades_ilicitas =
case_when(otras_actividades_ilicitas %in% v_narcomenudeo_simple    ~ "narcomenudeo_simple",
otras_actividades_ilicitas %in% v_narcomenudeo_delitos   ~ "narcomenudeo_delito",
otras_actividades_ilicitas %in% v_delitos_salud_delitos  ~ "delitos_salud_delitos",
otras_actividades_ilicitas %in% v_delitos_salud_simple   ~ "delitos_salud_simple",
otras_actividades_ilicitas %in% v_posesión_sus_simple    ~ "posesión_sus_simple",
otras_actividades_ilicitas %in% v_posesión_sus_delitos   ~ "v_posesión_sus_delitos",
otras_actividades_ilicitas == otras_actividades_ilicitas ~ otras_actividades_ilicitas))
df_detenciones <- df_monitor_amplio %>%
mutate(otras_actividades_ilicitas =
case_when(otras_actividades_ilicitas %in% v_narcomenudeo_simple    ~ "narcomenudeo_simple",
otras_actividades_ilicitas %in% v_narcomenudeo_delitos   ~ "narcomenudeo_delito",
otras_actividades_ilicitas %in% v_delitos_salud_delitos  ~ "delitos_salud_delitos",
otras_actividades_ilicitas %in% v_delitos_salud_simple   ~ "delitos_salud_simple",
otras_actividades_ilicitas %in% v_posesión_sus_simple    ~ "posesión_sus_simple",
otras_actividades_ilicitas %in% v_posesión_sus_delitos   ~ "v_posesión_sus_delitos",
otras_actividades_ilicitas == otras_actividades_ilicitas ~ otras_actividades_ilicitas)) %>%
filter(otras_actividades_ilicitas == c("narcomenudeo_simple",
"narcomenudeo_delito",
"delitos_salud_delitos",
"delitos_salud_simple",
"posesión_sus_simple",
"v_posesión_sus_delitos"))
df_detenciones <- df_monitor_amplio %>%
mutate(otras_actividades_ilicitas =
case_when(otras_actividades_ilicitas %in% v_narcomenudeo_simple    ~ "narcomenudeo_simple",
otras_actividades_ilicitas %in% v_narcomenudeo_delitos   ~ "narcomenudeo_delito",
otras_actividades_ilicitas %in% v_delitos_salud_delitos  ~ "delitos_salud_delitos",
otras_actividades_ilicitas %in% v_delitos_salud_simple   ~ "delitos_salud_simple",
otras_actividades_ilicitas %in% v_posesión_sus_simple    ~ "posesión_sus_simple",
otras_actividades_ilicitas %in% v_posesión_sus_delitos   ~ "v_posesión_sus_delitos",
otras_actividades_ilicitas == otras_actividades_ilicitas ~ otras_actividades_ilicitas)) %>%
filter(otras_actividades_ilicitas == c("narcomenudeo_simple", "narcomenudeo_delito", "delitos_salud_delitos",
"delitos_salud_simple", "posesión_sus_simple", "v_posesión_sus_delitos"))
View(df_detenciones)
df_detenciones <- df_monitor_amplio %>%
mutate(otras_actividades_ilicitas =
case_when(otras_actividades_ilicitas %in% v_narcomenudeo_simple    ~ "narcomenudeo_simple",
otras_actividades_ilicitas %in% v_narcomenudeo_delitos   ~ "narcomenudeo_delito",
otras_actividades_ilicitas %in% v_delitos_salud_delitos  ~ "delitos_salud_delitos",
otras_actividades_ilicitas %in% v_delitos_salud_simple   ~ "delitos_salud_simple",
otras_actividades_ilicitas %in% v_posesión_sus_simple    ~ "posesión_sus_simple",
otras_actividades_ilicitas %in% v_posesión_sus_delitos   ~ "v_posesión_sus_delitos",
otras_actividades_ilicitas == otras_actividades_ilicitas ~ otras_actividades_ilicitas))
View(df_detenciones)
unique(df_monitor_amplio$trafico)
v_sustancias_delitos <- c("armas; sustancias", "sustancias; armas; ropa táctica", "sustancias; armas",
"sustancias ; armas ; ropa táctica", "sustancias; animales", "sustancias; armas; placas policiales apócrifas",
"sustancias; personas", "sustancias; armas; uniformes", "armas; drogas", "sustancias; vehículos",
"armas; vehículos; sustancias", "armas: sustancias")
v_sustancias <- c("sustancias")
df_trafico <- df_monitor_amplio %>%
mutate(trafico =
case_when(trafico %in% v_sustancias_delitos    ~ "sustancias_delitos",
trafico %in% v_sustancias            ~ "narcomenudeo_delito",
trafico == trafico ~ trafico))
View(df_trafico)
df_trafico <- df_monitor_amplio %>%
mutate(trafico =
case_when(trafico %in% v_sustancias_delitos    ~ "sustancias_delitos",
trafico %in% v_sustancias            ~ "narcomenudeo_delito",
trafico == trafico ~ trafico)) %>%
filter(trafico == c("sustancias_delitos", "narcomenudeo_delito"))
df_trafico <- df_monitor_amplio %>%
mutate(trafico =
case_when(trafico %in% v_sustancias_delitos    ~ "sustancias_delitos",
trafico %in% v_sustancias            ~ "narcomenudeo_delito",
trafico == trafico ~ trafico)) %>%
filter(trafico == c("sustancias_delitos"))
filter(df_trafico, trafico %in% c("sustancias_delitos", "narcomenudeo_delito"))
df_trafico <- filter(df_trafico, trafico %in% c("sustancias_delitos", "narcomenudeo_delito"))
View(df_trafico)
df_trafico <- df_monitor_amplio %>%
mutate(trafico =
case_when(trafico %in% v_sustancias_delitos    ~ "sustancias_delitos",
trafico %in% v_sustancias            ~ "narcomenudeo_delito",
trafico == trafico ~ trafico))
df_trafico <- filter(df_trafico, trafico %in% c("sustancias_delitos", "narcomenudeo_delito"))
table(df_trafico$trafico)
df_trafico <- df_monitor_amplio %>%
mutate(trafico =
case_when(trafico %in% v_sustancias_delitos    ~ "sustancias_delitos",
trafico %in% v_sustancias            ~ "sustancia",
trafico == trafico ~ trafico))
df_trafico <- filter(df_trafico, trafico %in% c("sustancias_delitos", "sustancia"))
table(df_trafico$trafico)
colnames(df_trafico)
openxlsx::write.xlsx(df_trafico,
file = paste_out("df_trafico.xlsx"), overwrite = T)
v_narcomenudeo_simple <- c("narcomenudeo", "narcomenudista")
v_narcomenudeo_delitos <- c("narcomenudeo; robo; extorsión", "robo con violencia; narcomenudeo",
"robo; homicidio; narcomenudeo; robo de vehículo",
"homicidio; desaparición; narcomenudeo",
"narcomenudeo; feminicidio", "huachicol; narcomenudeo; posesión de armas")
v_delitos_salud_delitos <- c("delitos contra la salud, robo, abuso sexual",
"delitos contra la salud; robo", "portación de arma; delitos contra la salud",
"delito de delincuencia organizada con la finalidad de cometer un delito contra la salud")
v_delitos_salud_simple <- c("delitos contra la salud")
v_posesión_sus_simple <- c("posesión de sustancias", "posesión de drogas")
v_posesión_sus_delitos <- c("posesión de droga; posesión de arma", "robo casa habitación y a negocios; posesión de narcóticos",
"artefactos explosivos; cartuchos; vehículos; drogas ilícitas", "posesión de armas; posesión de sustancias",
"robo; posesión de sustancias")
df_trafico2 <- df_trafico %>%
mutate(otras_actividades_ilicitas =
case_when(otras_actividades_ilicitas %in% v_narcomenudeo_simple    ~ "narcomenudeo_simple",
otras_actividades_ilicitas %in% v_narcomenudeo_delitos   ~ "narcomenudeo_delito",
otras_actividades_ilicitas %in% v_delitos_salud_delitos  ~ "delitos_salud_delitos",
otras_actividades_ilicitas %in% v_delitos_salud_simple   ~ "delitos_salud_simple",
otras_actividades_ilicitas %in% v_posesión_sus_simple    ~ "posesión_sus_simple",
otras_actividades_ilicitas %in% v_posesión_sus_delitos   ~ "v_posesión_sus_delitos",
otras_actividades_ilicitas == otras_actividades_ilicitas ~ otras_actividades_ilicitas))
openxlsx::write.xlsx(df_trafico2,
file = paste_out("df_trafico.xlsx"), overwrite = T)
openxlsx::write.xlsx(df_trafico2,
file = paste_out("df_trafico.xlsx"), overwrite = T)
require(pacman)
p_load(
readxl, tidyverse, dplyr, srvyr, lubridate, zoo, ggtext, ggrepel, beepr)
options(dplyr.summarise.inform = FALSE)
load(paste_inp1("df_monitor_amplio.Rdata")) # datos de junio a octubre
m10 <- read_xlsx(paste_inp2("Monitor_PPD_noviembre.xlsx")) # datos noviembre
paste_inp1 <- function(x){paste0("03_datos_limpios/", x)}
paste_inp2 <- function(x){paste0("02_datos_crudos/" , x)}
paste_fig <- function(x){paste0("04_figuras/"      , x)}
paste_out <- function(x){paste0("03_datos_limpios/", x)}
load(paste_inp1("df_monitor_amplio.Rdata")) # datos de junio a octubre
m10 <- read_xlsx(paste_inp2("Monitor_PPD_noviembre.xlsx")) # datos noviembre
rm(list = ls ())
paste_inp1 <- function(x){paste0("03_datos_limpios/", x)}
paste_inp2 <- function(x){paste0("02_datos_crudos/" , x)}
paste_fig <- function(x){paste0("04_figuras/"      , x)}
paste_out <- function(x){paste0("03_datos_limpios/", x)}
df_full <- load(paste_inp1("df_monitor_amplio.Rdata")) # junio a octubre
df_nov <- read_xlsx(paste_inp2("Monitor_PPD_noviembre.xlsx")) # noviembre
View(df_monitor_amplio)
unique(df_monitor_amplio$trafico)
df_full <- df_monitor_amplio %>%
select(id,
fecha_de_publicacion         = publicacion,
enlace,
titulo_de_la_nota            = titulo,
fecha_de_los_hechos          = fecha_hechos,
estado,
municipio,
lugar,
numero_de_detenidos_as_total = detenidos_t,
numero_de_detenidos_hombres  = detenidos_h,
numero_de_heridas_mujeres    = detenidos_m,
detenido_a_pertenece_a       = detenido_pertenece,
trafico,
otras_actividades_ilicitas   = otra_actividad,
ataque_armado                = ataque,
privacion_de_la_libertad     = secuestro,
narcomensaje,
contenido_del_narcomensaje   = contenido_narcomensaje,
autoridad_militar            = militar,
tipo_de_actividad_militar    = militar_actividad,
autoridad_civil              = civil,
tipo_de_actividad_civil      = civil_actividad,
politica_de_seguridad        = politica_seguridad,
nombre_del_grupo_criminal_gc = grupo_criminal,
alianza_del_gc               = alianza_grupo,
rival_del_gc                 = rival_grupo,
numero_de_homicidios_total   = homicidios_t,
numero_de_detenidos_hombres  = homicidios_h,
numero_de_heridas_mujeres    = homicidios_m,
pertenece_a                  = homicidio_pertenece,
cuerpo_s_localizado_s        = cuerpo_localizado,
numero_de_heridos_as_total   = heridos_t,
numero_de_detenidos_hombres  = heridos_h,
numero_de_heridas_mujeres    = heridos_m,
herido_a_pertenece_a         = herido_pertenece)
# 2. Procesamiento--------------------------------------------------------------
df_full <- df_monitor_amplio %>%
select(id,
publicacion                  = fecha_de_publicacion,
enlace,
titulo                       = titulo_de_la_nota,
fecha_hechos                 = fecha_de_los_hechos,
estado,
municipio,
lugar,
detenidos_t                  = numero_de_detenidos_as_total,
detenidos_h                  = numero_de_detenidos_hombres,
detenidos_m                  = numero_de_heridas_mujeres,
detenido_pertenece           = detenido_a_pertenece_a,
trafico,
otra_actividad               = otras_actividades_ilicitas,
ataque                       = ataque_armado,
secuestro                    = privacion_de_la_libertad,
narcomensaje,
contenido_narcomensaje       = contenido_del_narcomensaje,
militar                      = autoridad_militar,
militar_actividad            = tipo_de_actividad_militar,
civil                        = autoridad_civil,
civil_actividad              = tipo_de_actividad_civil,
politica_seguridad           = politica_de_seguridad,
grupo_criminal               = nombre_del_grupo_criminal_gc,
alianza_grupo                = alianza_del_gc,
rival_grupo                  = rival_del_gc,
homicidios_t                 = numero_de_homicidios_total,
homicidios_h                 = numero_de_detenidos_hombres,
homicidios_m                 = numero_de_heridas_mujeres,
homicidio_pertenece          = pertenece_a,
cuerpo_localizado            = cuerpo_s_localizado_s,
heridos_t                    = numero_de_heridos_as_total,
heridos_h                    = numero_de_detenidos_hombres,
heridos_m                    = numero_de_heridas_mujeres,
herido_pertenece             = herido_a_pertenece_a)
count(df_monitor_amplio, trafico, sort = T)
v_sustancias         <- c("Cocaina", "sustancias", "cocaina" )
v_sustancias_delitos <- c("armas; sustancias", "sustancias; armas; ropa táctica",
"sustancias; armas", "sustancias ; armas ; ropa táctica",
"sustancias; armas; placas policiales apócrifas",
"sustancias; animales", "sustancias; personas",
"sustancias; armas; uniformes", "armas; drogas",
"sustancias; vehículos", "armas; vehículos; sustancias",
"armas: sustancias")
df_full <- df_monitor_amplio %>%
select(id,
publicacion                  = fecha_de_publicacion,
enlace,
titulo                       = titulo_de_la_nota,
fecha_hechos                 = fecha_de_los_hechos,
estado,
municipio,
lugar,
detenidos_t                  = numero_de_detenidos_as_total,
detenidos_h                  = numero_de_detenidos_hombres,
detenidos_m                  = numero_de_heridas_mujeres,
detenido_pertenece           = detenido_a_pertenece_a,
trafico,
otra_actividad               = otras_actividades_ilicitas,
ataque                       = ataque_armado,
secuestro                    = privacion_de_la_libertad,
narcomensaje,
contenido_narcomensaje       = contenido_del_narcomensaje,
militar                      = autoridad_militar,
militar_actividad            = tipo_de_actividad_militar,
civil                        = autoridad_civil,
civil_actividad              = tipo_de_actividad_civil,
politica_seguridad           = politica_de_seguridad,
grupo_criminal               = nombre_del_grupo_criminal_gc,
alianza_grupo                = alianza_del_gc,
rival_grupo                  = rival_del_gc,
homicidios_t                 = numero_de_homicidios_total,
homicidios_h                 = numero_de_detenidos_hombres,
homicidios_m                 = numero_de_heridas_mujeres,
homicidio_pertenece          = pertenece_a,
cuerpo_localizado            = cuerpo_s_localizado_s,
heridos_t                    = numero_de_heridos_as_total,
heridos_h                    = numero_de_detenidos_hombres,
heridos_m                    = numero_de_heridas_mujeres,
herido_pertenece             = herido_a_pertenece_a) %>%
mutate(trafico =
case_when(trafico %in% v_sustancias ~ "sustancias",
trafico %in% v_sustancias_delitos ~ "sustancias_delitos",
trafico == trafico ~ trafico))
df_full <- df_monitor_amplio %>%
select(id,
publicacion                  = fecha_de_publicacion,
enlace,
titulo                       = titulo_de_la_nota,
fecha_hechos                 = fecha_de_los_hechos,
estado,
municipio,
lugar,
detenidos_t                  = numero_de_detenidos_as_total,
detenidos_h                  = numero_de_detenidos_hombres,
detenidos_m                  = numero_de_heridas_mujeres,
detenido_pertenece           = detenido_a_pertenece_a,
trafico,
otra_actividad               = otras_actividades_ilicitas,
ataque                       = ataque_armado,
secuestro                    = privacion_de_la_libertad,
narcomensaje,
contenido_narcomensaje       = contenido_del_narcomensaje,
militar                      = autoridad_militar,
militar_actividad            = tipo_de_actividad_militar,
civil                        = autoridad_civil,
civil_actividad              = tipo_de_actividad_civil,
politica_seguridad           = politica_de_seguridad,
grupo_criminal               = nombre_del_grupo_criminal_gc,
alianza_grupo                = alianza_del_gc,
rival_grupo                  = rival_del_gc,
homicidios_t                 = numero_de_homicidios_total,
homicidios_h                 = numero_de_detenidos_hombres,
homicidios_m                 = numero_de_heridas_mujeres,
homicidio_pertenece          = pertenece_a,
cuerpo_localizado            = cuerpo_s_localizado_s,
heridos_t                    = numero_de_heridos_as_total,
heridos_h                    = numero_de_detenidos_hombres,
heridos_m                    = numero_de_heridas_mujeres,
herido_pertenece             = herido_a_pertenece_a) %>%
mutate(trafico =
case_when(trafico %in% v_sustancias ~ "sustancias",
trafico %in% v_sustancias_delitos ~ "sustancias_delitos",
trafico == trafico ~ trafico)) %>%
filter(trafico %in% c("sustancias", "sustancias_delitos"))
View(df_full)
df_detenciones <- df_monitor_amplio %>%
select(id,
publicacion                  = fecha_de_publicacion,
enlace,
titulo                       = titulo_de_la_nota,
fecha_hechos                 = fecha_de_los_hechos,
estado,
municipio,
lugar,
detenidos_t                  = numero_de_detenidos_as_total,
detenidos_h                  = numero_de_detenidos_hombres,
detenidos_m                  = numero_de_heridas_mujeres,
detenido_pertenece           = detenido_a_pertenece_a,
trafico,
otra_actividad               = otras_actividades_ilicitas,
ataque                       = ataque_armado,
secuestro                    = privacion_de_la_libertad,
narcomensaje,
contenido_narcomensaje       = contenido_del_narcomensaje,
militar                      = autoridad_militar,
militar_actividad            = tipo_de_actividad_militar,
civil                        = autoridad_civil,
civil_actividad              = tipo_de_actividad_civil,
politica_seguridad           = politica_de_seguridad,
grupo_criminal               = nombre_del_grupo_criminal_gc,
alianza_grupo                = alianza_del_gc,
rival_grupo                  = rival_del_gc,
homicidios_t                 = numero_de_homicidios_total,
homicidios_h                 = numero_de_detenidos_hombres,
homicidios_m                 = numero_de_heridas_mujeres,
homicidio_pertenece          = pertenece_a,
cuerpo_localizado            = cuerpo_s_localizado_s,
heridos_t                    = numero_de_heridos_as_total,
heridos_h                    = numero_de_detenidos_hombres,
heridos_m                    = numero_de_heridas_mujeres,
herido_pertenece             = herido_a_pertenece_a) %>%
mutate(trafico =
case_when(trafico %in% v_sustancias ~ "sustancias",
trafico %in% v_sustancias_delitos ~ "sustancias_delitos",
trafico == trafico ~ trafico)) %>%
filter(trafico %in% c("sustancias", "sustancias_delitos"))
rm(df_full)
View(df_nov)
df_detenciones2 <- df_nov %>%
janitor::clean_names()
View(df_detenciones2)
View(df_detenciones2)
colnames(df_detenciones2)
df_detenciones2 <- df_nov %>%
janitor::clean_names() %>%
select(id,
publicacion            = x1_2_1_fecha_de_publicacion,
enlace                 = x1_2_2_enlace,
titulo                 = x1_2_3_titulo_de_la_nota,
fecha_hechos           = x1_3_1_fecha_de_los_hechos,
estado                 = x1_3_3_estado,
municipio              = x1_3_4_municipio,
lugar                  = x1_3_5_lugar,
detenidos_t            = x3_1_1_numero_de_detenidos_as_total,
detenidos_h            = x3_1_2_numero_de_detenidos_hombres,
detenidos_m            = x2_3_3_numero_de_heridas_mujeres,
detenido_pertenece     = x3_1_4_detenido_a_pertenece_a_ocupacion,
actividad_delictiva    = x4_1_1_actividades_delictivas,
institucion_detencion  = x3_1_5_institucion_que_detiene,
ataque                 = x2_1_1_ataque,
secuestro              = x4_1_2_privacion_de_la_libertad,
narcomensaje           = x5_1_1_narcomensaje,
contenido_narcomensaje = x5_1_2_contenido_del_narcomensaje,
autoridad              = x6_1_autoridad,
autoridad_actividad    = x6_2_tipo_de_actividad_de_la_autoridad,
politica_seguridad     = x7_1_politica_de_seguridad,
grupo_criminal         = x5_1_3_nombre_del_grupo_criminal_gc,
alianza_grupo          = x5_1_4_alianza_del_gc,
rival_grupo            = x5_1_5_rival_del_gc,
homicidios_t           = x2_2_1_numero_de_homicidios_total,
homicidios_h           = x2_2_2_numero_de_homicidios_hombre,
homicidios_m           = x2_2_3_numero_de_homicidios_mujer,
homicidio_pertenece    = x2_2_4_pertenece_a_ocupacion,
cuerpo_localizado      = x2_2_6_cuerpo_localizado_restos_humanos,
heridos_t              = x2_3_1_numero_de_heridos_as_total,
heridos_h              = x2_3_2_numero_de_heridos_hombres,
heridos_m              = x2_3_3_numero_de_heridas_mujeres,
herido_pertenece       = x2_3_4_herido_a_pertenece_a_ocupacion)
unique(df_nov$trafico)
unique(df_nov$actividad_delictiva)
unique(df_detenciones2$actividad_delictiva)
v_sustancias11         <- c("sustancias ilegales", "tráfico de sustancias",
"posesión de sustancias", )
v_sustancias_delitos11 <- c("sustancias ilegales; portación de armas",
"tráfico de armas; tráfico de sustancias",
"huachicol; sustancias ilícitas",
"trafico de sustancias; portación de armas",
"robo; tráfico de sustancias",
"portación de armas; secuestro; sustancias ilegales",
"sustancias ilegales; billetes falsos",
"enfrentamiento; portación de armas; sustancias ilegales",
"armas. sustancias ilegales", "portación de armas; sustancias ilegales",
"sustancias ilegales; préstamos fraudulentos gota a gota")
v_sustancias11         <- c("sustancias ilegales", "tráfico de sustancias",
"posesión de sustancias")
v_sustancias_delitos11 <- c("sustancias ilegales; portación de armas",
"tráfico de armas; tráfico de sustancias",
"huachicol; sustancias ilícitas",
"trafico de sustancias; portación de armas",
"robo; tráfico de sustancias",
"portación de armas; secuestro; sustancias ilegales",
"sustancias ilegales; billetes falsos",
"enfrentamiento; portación de armas; sustancias ilegales",
"armas. sustancias ilegales", "portación de armas; sustancias ilegales",
"sustancias ilegales; préstamos fraudulentos gota a gota")
df_detenciones2 <- df_detenciones2 %>%
mutate(actividad_delictiva =
case_when(actividad_delictiva %in% v_sustancias11 ~ "sustancias",
actividad_delictiva %in% v_sustancias_delitos11 ~ "sustancias_delitos",
actividad_delictiva == actividad_delictiva ~ actividad_delictiva))
df_detenciones2 <- df_detenciones2 %>%
mutate(actividad_delictiva =
case_when(actividad_delictiva %in% v_sustancias11 ~ "sustancias",
actividad_delictiva %in% v_sustancias_delitos11 ~ "sustancias_delitos",
actividad_delictiva == actividad_delictiva ~ actividad_delictiva)) %>%
filter(actividad_delictiva %in% c("sustancias", "sustancias_delitos"))
df_detenciones2 <- df_nov %>%
janitor::clean_names() %>%
select(id,
publicacion            = x1_2_1_fecha_de_publicacion,
enlace                 = x1_2_2_enlace,
titulo                 = x1_2_3_titulo_de_la_nota,
fecha_hechos           = x1_3_1_fecha_de_los_hechos,
estado                 = x1_3_3_estado,
municipio              = x1_3_4_municipio,
lugar                  = x1_3_5_lugar,
detenidos_t            = x3_1_1_numero_de_detenidos_as_total,
detenidos_h            = x3_1_2_numero_de_detenidos_hombres,
detenidos_m            = x2_3_3_numero_de_heridas_mujeres,
detenido_pertenece     = x3_1_4_detenido_a_pertenece_a_ocupacion,
actividad_delictiva    = x4_1_1_actividades_delictivas,
institucion_detiene    = x3_1_5_institucion_que_detiene,
ataque                 = x2_1_1_ataque,
secuestro              = x4_1_2_privacion_de_la_libertad,
narcomensaje           = x5_1_1_narcomensaje,
contenido_narcomensaje = x5_1_2_contenido_del_narcomensaje,
autoridad              = x6_1_autoridad,
autoridad_actividad    = x6_2_tipo_de_actividad_de_la_autoridad,
politica_seguridad     = x7_1_politica_de_seguridad,
grupo_criminal         = x5_1_3_nombre_del_grupo_criminal_gc,
alianza_grupo          = x5_1_4_alianza_del_gc,
rival_grupo            = x5_1_5_rival_del_gc,
homicidios_t           = x2_2_1_numero_de_homicidios_total,
homicidios_h           = x2_2_2_numero_de_homicidios_hombre,
homicidios_m           = x2_2_3_numero_de_homicidios_mujer,
homicidio_pertenece    = x2_2_4_pertenece_a_ocupacion,
cuerpo_localizado      = x2_2_6_cuerpo_localizado_restos_humanos,
heridos_t              = x2_3_1_numero_de_heridos_as_total,
heridos_h              = x2_3_2_numero_de_heridos_hombres,
heridos_m              = x2_3_3_numero_de_heridas_mujeres,
herido_pertenece       = x2_3_4_herido_a_pertenece_a_ocupacion)
unique(df_detenciones2$actividad_delictiva)
v_sustancias11         <- c("sustancias ilegales", "tráfico de sustancias",
"posesión de sustancias")
v_sustancias_delitos11 <- c("sustancias ilegales; portación de armas",
"tráfico de armas; tráfico de sustancias",
"huachicol; sustancias ilícitas",
"trafico de sustancias; portación de armas",
"robo; tráfico de sustancias",
"portación de armas; secuestro; sustancias ilegales",
"sustancias ilegales; billetes falsos",
"enfrentamiento; portación de armas; sustancias ilegales",
"armas. sustancias ilegales", "portación de armas; sustancias ilegales",
"sustancias ilegales; préstamos fraudulentos gota a gota")
df_detenciones2 <- df_detenciones2 %>%
mutate(actividad_delictiva =
case_when(actividad_delictiva %in% v_sustancias11 ~ "sustancias",
actividad_delictiva %in% v_sustancias_delitos11 ~ "sustancias_delitos",
actividad_delictiva == actividad_delictiva ~ actividad_delictiva)) %>%
filter(actividad_delictiva %in% c("sustancias", "sustancias_delitos"))
openxlsx::write.xlsx(df_detenciones, file = paste_out("detenciones6_10.xlsx"), overwrite = T)
openxlsx::write.xlsx(df_detenciones2, file = paste_out("detenciones11.xlsx"), overwrite = T)
